!function(e){var t=navigator.platform,a=null,n="iPad"===t||"iPhone"===t||"iPod"===t,i="undefined"!=typeof InstallTrigger,r=function(t,a){if(null!==a&&"undefined"!=typeof a)for(var n in a)e(t).data("autotab-"+n,a[n])},l=function(t){var a,n={format:"all",loaded:!1,disabled:!1,pattern:null,uppercase:!1,lowercase:!1,nospace:!1,maxlength:2147483647,target:null,previous:null,trigger:null,originalValue:"",changed:!1};for(a in n)n[a]=e(t).data("autotab-"+a)||n[a];return n.loaded||(null!==n.trigger&&"string"==typeof n.trigger&&(n.trigger=n.trigger.toString()),r(t,n)),n};e.autotab={next:function(){var t=e(document.activeElement);t.length&&t.trigger("autotab-next")},previous:function(){var t=e(document.activeElement);t.length&&t.trigger("autotab-previous")}},e.fn.autotab=function(t,a){if(!this.length)return this;if("filter"==t){"string"!=typeof a&&"function"!=typeof a||(a={format:a});for(var n=0,i=this.length;i>n;n++){var o=l(this[n]),u=a;u.target=o.target,u.previous=o.previous,e.extend(o,u),o.loaded?r(this[n],o):(o.disabled=!0,s(this[n],u))}}else if("remove"==t||"destroy"==t||"disable"==t)for(n=0,i=this.length;i>n;n++)o=l(this[n]),o.disabled=!0,r(this[n],o);else if("restore"==t||"enable"==t)for(n=0,i=this.length;i>n;n++)o=l(this[n]),o.disabled=!1,r(this[n],o);else if(null===t||"undefined"==typeof t?a={}:"string"==typeof t||"function"==typeof t?a={format:t}:"object"==typeof t&&(a=t),1<this.length)for(n=0,i=this.length;i>n;n++){var o=n+1,g=n-1,u=a;n>0&&i>o?(u.target=this[o],u.previous=this[g]):n>0?(u.target=null,u.previous=this[g]):(u.target=this[o],u.previous=null),s(this[n],u)}else s(this[0],a);return this};var o=function(e,t,a){if("function"==typeof a.format)return a.format(t,e);switch(e=null,a.format){case"text":e=RegExp("[0-9]+","g");break;case"alpha":e=RegExp("[^a-zA-Z]+","g");break;case"number":case"numeric":e=RegExp("[^0-9]+","g");break;case"alphanumeric":e=RegExp("[^0-9a-zA-Z]+","g");break;case"hex":case"hexadecimal":e=RegExp("[^0-9A-Fa-f]+","g");break;case"custom":e=RegExp(a.pattern,"g")}return null!==e&&(t=t.replace(e,"")),a.nospace&&(e=RegExp("[ ]+","g"),t=t.replace(e,"")),a.uppercase&&(t=t.toUpperCase()),a.lowercase&&(t=t.toLowerCase()),t},s=function(t,s){var u=l(t);u.disabled&&(u.disabled=!1,u.target=null,u.previous=null),e.extend(u,s),"string"!=typeof u.target&&u.target instanceof jQuery||(u.target=e(u.target)),"string"!=typeof u.previous&&u.previous instanceof jQuery||(u.previous=e(u.previous));var g=t.maxLength;2147483647==u.maxlength&&2147483647!=g&&-1!=g?u.maxlength=g:0<u.maxlength?t.maxLength=u.maxlength:u.target=null,u.loaded?r(t,u):(u.loaded=!0,r(t,u),e(t).on("autotab-next",function(e,t){var i=this;setTimeout(function(){t||(t=l(i)),t.disabled||!t.target.length||n||(t.target.focus().select(),a=new Date)},1)}).on("autotab-previous",function(e,t){var n=this;setTimeout(function(){t||(t=l(n));var e=t.previous;if(!t.disabled&&e.length){var i=e.val();i.length?(e.focus().val(i.substring(0,i.length-1)),r(e,{changed:!0})):e.focus(),a=null}},1)}).on("focus",function(){r(this,{originalValue:this.value})}).on("blur",function(){var t=l(this);t.changed&&this.value!=t.originalValue&&(r(this,{changed:!1}),e(this).change())}).on("keydown",function(t){var n=l(this);if(!n||n.disabled)return!0;var i=t.which||t.charCode;if(8==i)0===this.value.length&&n.previous.length?e(this).trigger("autotab-previous",n):r(this,{changed:this.value!=n.originalValue});else if(9==i&&null!==a)if(t.shiftKey)a=null;else if(800>(new Date).getTime()-a.getTime())return a=null,!1}).on("keypress",function(t){var n=l(this),s=t.which||t.keyCode;if(!n||n.disabled||i&&0===t.charCode||t.ctrlKey||t.altKey||13==s||"text"!=this.type&&"password"!=this.type)return!0;if(s=String.fromCharCode(s),null!==n.trigger&&0<=n.trigger.indexOf(s))return null!==a&&800>(new Date).getTime()-a.getTime()?a=null:e(this).trigger("autotab-next",n),!1;if(a=null,t=document.selection&&document.selection.createRange?!0:0<t.charCode,s=o(this,s,n),t&&(null===s||""===s))return!1;if(t&&this.value.length<=this.maxLength){var u,g;if(t=0,"number"==typeof this.selectionStart&&"number"==typeof this.selectionEnd)u=this.selectionStart,g=this.selectionEnd,t=1;else if(document.selection&&document.selection.createRange){g=document.selection.createRange(),u=this.createTextRange(),t=this.createTextRange();var h=g.getBookmark();u.moveToBookmark(h),t.setEndPoint("EndToStart",u),u=t.text.length,g=u+g.text.length,t=2}if(0===u&&g==this.value.length)this.value=s;else{if(this.value.length==this.maxLength&&u===g)return e(this).trigger("autotab-next",n),!1;this.value=this.value.slice(0,u)+s+this.value.slice(g)}r(this,{changed:this.value!=n.originalValue}),this.value.length!=n.maxlength&&(u++,1==t?this.selectionStart=this.selectionEnd=u:2==t&&(s=this.createTextRange(),s.collapse(!0),s.moveEnd("character",u),s.moveStart("character",u),s.select()))}return this.value.length==n.maxlength&&e(this).trigger("autotab-next",n),!1}).on("paste",function(t){var a=l(this);return a?(this.maxLength=2147483647,void function(t,i){setTimeout(function(){var r=-1,s=document.createElement("input");s.type="hidden",s.value=t.value.toLowerCase(),t.maxLength=i.maxlength,t.value=o(t,t.value,i).substr(0,i.maxlength);var u=function(t,a){if(t){for(var i=0,g=a.length;g>i;i++)r=s.value.indexOf(a.charAt(i),r)+1;i=l(t),g=s.value.substr(r),(g=o(t,g,i).substr(0,i.maxlength))?(t.value=g,g.length==i.maxlength&&(e(t).trigger("autotab-next",i),n||u(i.target[0],g))):t.value=""}};t.value.length==i.maxlength&&(e(t).trigger("autotab-next",a),n||u(i.target[0],t.value.toLowerCase()))},1)}(this,a)):!0}))};e.fn.autotab_magic=function(t){e(this).autotab()},e.fn.autotab_filter=function(t){var a={};"string"==typeof t||"function"==typeof t?a.format=t:e.extend(a,t),e(this).autotab("filter",a)}}(jQuery);